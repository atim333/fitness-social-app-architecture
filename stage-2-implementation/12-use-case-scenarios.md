# 12. Сценарии использования приложения

## Обзор
Сценарии использования (Use Cases) описывают взаимодействие пользователей с системой для достижения конкретных целей. Эти сценарии используются для проектирования пользовательского интерфейса, API и бизнес-логики.

## Основные акторы (Actors)

### Первичные акторы:
1. **Новичок (Beginner)** - новый пользователь, только установивший приложение
2. **Активный пользователь (Active User)** - регулярно использующий приложение для тренировок
3. **Социальный лидер (Social Leader)** - пользователь, активно участвующий в группах и соревнованиях
4. **Профессиональный спортсмен (Pro Athlete)** - пользователь с высокими требованиями к аналитике и устройствам
5. **Администратор (Admin)** - сотрудник компании, управляющий контентом и промоакциями

### Вторичные акторы:
6. **Система рекомендаций (Recommendation System)** - автоматическая система рекомендаций
7. **Внешние устройства (External Devices)** - фитнес-браслеты, датчики
8. **Платежная система (Payment System)** - внешние системы обработки платежей

---

## Use Case 1: Регистрация и создание профиля

### ID:
UC-001

### Акторы:
Новичок

### Предусловия:
Пользователь скачал и открыл приложение впервые.

### Основной поток:
1. Пользователь нажимает "Начать"
2. Система предлагает войти через социальные сети или зарегистрироваться по email
3. Пользователь выбирает "Регистрация по email"
4. Система запрашивает email, пароль и подтверждение пароля
5. Пользователь вводит данные и нажимает "Продолжить"
6. Система отправляет письмо для подтверждения email
7. Пользователь подтверждает email и возвращается в приложение
8. Система запрашивает базовую информацию (имя, дата рождения, пол)
9. Пользователь вводит данные
10. Система предлагает выбрать спортивные интересы из списка (бег, йога, велоспорт и т.д.)
11. Пользователь выбирает 3-5 интересов
12. Система предлагает указать уровень подготовки (новичок, любитель, профессионал)
13. Пользователь выбирает уровень
14. Система создает профиль и показывает приветственный экран с кратким туром по основным функциям

### Альтернативный поток A: Регистрация через социальные сети
1. На шаге 2 пользователь выбирает "Войти через Facebook/Google/Apple"
2. Система перенаправляет в сервис аутентификации
3. Пользователь подтверждает доступ
4. Система получает базовую информацию из социального профиля
5. Переход к шагу 8 основного потока

### Альтернативный поток B: Пропуск шагов настройки
1. На шагах 8-13 пользователь может нажать "Пропустить"
2. Система создает профиль с минимальными данными
3. Пользователь может заполнить профиль позже в настройках

### Постусловия:
Создан профиль пользователя. Пользователь перенаправлен на главный экран приложения.

---

## Use Case 2: Завершение тренировки с трекингом

### ID:
UC-002

### Акторы:
Активный пользователь, Внешние устройства (опционально)

### Предусловия:
Пользователь авторизован в приложении. Приложение имеет доступ к данным о местоположении (для outdoor-тренировок).

### Основной поток:
1. Пользователь нажимает "Начать тренировку" на главном экране
2. Система показывает экран выбора типа тренировки (бег, ходьба, велосипед, йога и т.д.)
3. Пользователь выбирает "Бег"
4. Система предлагает выбрать цель (расстояние, время, калории) или тренировку без цели
5. Пользователь выбирает "5 км" в качестве цели
6. Система показывает экран подготовки с таймером 3-2-1
7. Начинается трекинг тренировки:
   - Отображается текущее время, расстояние, темп, калории
   - На карте отображается маршрут (если outdoor)
   - Система периодически озвучивает прогресс (каждые 500 метров)
8. Пользователь завершает тренировку, нажав "Стоп"
9. Система показывает экран результатов:
   - Общая статистика (время, расстояние, средний темп, калории)
   - Достижения (если есть)
   - Сравнение с предыдущими тренировками
10. Пользователь может добавить заметки или фото к тренировке
11. Пользователь нажимает "Сохранить"
12. Система сохраняет тренировку, обновляет статистику пользователя

### Альтернативный поток A: Использование внешнего устройства
1. На шаге 1 система обнаруживает подключенное фитнес-устройство (например, Apple Watch)
2. Система предлагает использовать данные с устройства
3. Пользователь подтверждает
4. Во время тренировки отображаются дополнительные метрики (пульс, высота, cadence)
5. После завершения данные синхронизируются с устройством

### Альтернативный поток B: Пауза во время тренировки
1. Во время тренировки пользователь нажимает "Пауза"
2. Трекинг приостанавливается
3. Пользователь может возобновить тренировку или завершить ее

### Альтернативный поток C: Автоматическое определение паузы
1. Во время бега пользователь останавливается (например, на светофоре)
2. Система автоматически ставит на паузу через 10 секунд остановки
3. При возобновлении движения система автоматически возобновляет трекинг

### Постусловия:
Тренировка сохранена. Статистика пользователя обновлена. Если достигнуты новые достижения - показываются уведомления.

---

## Use Case 3: Создание социальной группы

### ID:
UC-003

### Акторы:
Социальный лидер

### Предусловия:
Пользователь авторизован. Пользователь имеет минимум 3 завершенные тренировки.

### Основной поток:
1. Пользователь переходит в раздел "Сообщество"
2. Пользователь нажимает "Создать группу"
3. Система запрашивает название группы
4. Пользователь вводит "Бегуны Москвы"
5. Система запрашивает описание группы
6. Пользователь вводит "Группа для любителей бега в Москве"
7. Система предлагает выбрать тип группы (открытая, закрытая, приватная)
8. Пользователь выбирает "Открытая"
9. Система предлагает выбрать интересы группы (бег, марафон, parkrun)
10. Пользователь выбирает соответствующие интересы
11. Система предлагает установить географические ограничения (город, район)
12. Пользователь выбирает "Москва"
13. Система создает группу и назначает пользователя администратором
14. Система показывает экран управления группой

### Альтернативный поток A: Создание группы по шаблону
1. На шаге 2 пользователь выбирает "Создать по шаблону"
2. Система предлагает шаблоны (Челлендж на месяц, Подготовка к марафону, Утренние пробежки)
3. Пользователь выбирает шаблон
4. Система заполняет часть полей автоматически
5. Пользователь корректирует при необходимости и сохраняет

### Альтернативный поток B: Ограничение по уровню подготовки
1. На шаге 11 система предлагает установить ограничения по уровню подготовки
2. Пользователь выбирает "Только для продвинутых"
3. В группу смогут вступить только пользователи с уровнем "любитель" или "профессионал"

### Постусловия:
Создана новая социальная группа. Пользователь является администратором группы. Группа отображается в поиске для других пользователей.

---

## Use Case 4: Участие в групповом челлендже

### ID:
UC-004

### Акторы:
Активный пользователь, Социальный лидер, Система рекомендаций

### Предусловия:
Пользователь состоит как минимум в одной группе. В группе активен челлендж.

### Основной поток:
1. Пользователь заходит в группу "Бегуны Москвы"
2. Система показывает активный челлендж "100 км за январь"
3. Пользователь нажимает "Участвовать"
4. Система добавляет пользователя в список участников челленджа
5. Пользователь завершает тренировку (UC-002)
6. Система автоматически добавляет километраж к челленджу
7. Пользователь заходит в раздел челленджа
8. Система показывает:
   - Прогресс пользователя (например, 35/100 км)
   - Рейтинг участников
   - Оставшееся время (например, 15 дней)
9. По завершении челленджа система определяет победителей
10. Пользователь получает уведомление о результатах

### Альтернативный поток A: Рекомендация челленджа
1. Пользователь заходит в приложение
2. Система рекомендаций предлагает присоединиться к челленджу на основе истории тренировок
3. Пользователь принимает предложение
4. Переход к шагу 4 основного потока

### Альтернативный поток B: Создание личного челленджа на основе группового
1. На шаге 3 пользователь нажимает "Создать личную цель"
2. Система предлагает скорректировать цель (например, 50 км вместо 100 км)
3. Пользователь устанавливает личную цель
4. Система создает персональный челлендж на основе группового

### Постусловия:
Пользователь участвует в челлендже. Прогресс тренировок учитывается в челлендже. По завершении пользователь получает виртуальные или реальные награды.

---

## Use Case 5: Получение рекомендаций по обновлению экипировки

### ID:
UC-005

### Акторы:
Профессиональный спортсмен, Система рекомендаций

### Предусловия:
Пользователь указал свой спортивный инвентарь в профиле. Пользователь активно тренируется.

### Основной поток:
1. Пользователь завершил 500-ю тренировку по бегу
2. Система анализирует:
   - Пробег текущей обуви (например, 800 км)
   - Средний темп и износ
   - Тип тренировок (дорожка, асфальт, трейл)
3. Система отправляет push-уведомление: "Ваши кроссовки прошли 800 км. Рекомендуем обновить обувь для предотвращения травм"
4. Пользователь нажимает на уведомление
5. Система показывает детализированный отчет:
   - История использования текущей обуви
   - Рекомендации по выбору новой обуви
   - Сравнение моделей
6. Система предлагает подходящие модели из ассортимента компании
7. Пользователь выбирает "Посмотреть рекомендации"
8. Система показывает персонализированные рекомендации с фильтрами:
   - Для бега по асфальту
   - Амортизация
   - Вес
9. Пользователь выбирает модель и нажимает "Купить"
10. Система перенаправляет в магазин компании с предзаполненной корзиной

### Альтернативный поток A: Активное запрашивание рекомендаций
1. Пользователь заходит в раздел "Мой инвентарь"
2. Пользователь нажимает "Получить рекомендации"
3. Система анализирует данные и показывает рекомендации

### Альтернативный поток B: Рекомендации на основе промоакции
1. В компании проходит промоакция на беговые кроссовки
2. Система рекомендует обновить обувь пользователям, у которых пробег превышает 600 км
3. В рекомендации включается информация о скидке

### Постусловия:
Пользователь получил персонализированные рекомендации. Пользователь может перейти к покупке рекомендованного товара.

---

## Use Case 6: Организация оффлайн-встречи для совместной тренировки

### ID:
UC-006

### Акторы:
Социальный лидер, Активный пользователь

### Предусловия:
Пользователь состоит в группе. Пользователь имеет друзей в приложении.

### Основной поток:
1. Пользователь заходит в группу "Бегуны Москвы"
2. Пользователь нажимает "Организовать встречу"
3. Система запрашивает тип встречи (тренировка, соревнование, семинар)
4. Пользователь выбирает "Совместная тренировка"
5. Система запрашивает дату и время
6. Пользователь выбирает завтра, 19:00
7. Система предлагает выбрать место на карте или ввести адрес
8. Пользователь выбирает "Парк Горького, главный вход"
9. Система показывает карту с выбранным местом
10. Пользователь добавляет описание: "Легкая пробежка 5 км для всех уровней"
11. Пользователь устанавливает максимальное количество участников (20 человек)
12. Система создает событие и публикует в группе
13. Другие пользователи видят событие и могут записаться
14. За день до события система отправляет напоминание всем записавшимся

### Альтернативный поток A: Приглашение друзей напрямую
1. После создания события пользователь нажимает "Пригласить друзей"
2. Система показывает список друзей
3. Пользователь выбирает друзей для приглашения
4. Система отправляет персональные приглашения

### Альтернативный поток B: Повторяющееся событие
1. На шаге 5 пользователь выбирает "Повторяющееся событие"
2. Система предлагает выбрать частоту (еженедельно, по вторникам и четвергам)
3. Пользователь устанавливает повторение
4. Система создает серию событий

### Постусловия:
Создано событие для совместной тренировки. Участники группы могут записаться. Система отправляет уведомления и напоминания.

---

## Use Case 7: Использование приложения в регионе без стабильного интернета

### ID:
UC-007

### Акторы:
Активный пользователь

### Предусловия:
Пользователь собирается в поход в горный регион. Пользователь заранее загрузил карты.

### Основной поток:
1. Пользователь включает режим "Оффлайн" в настройках
2. Пользователь начинает тренировку (поход) без подключения к интернету
3. Система записывает трек, используя GPS телефона
4. Система сохраняет данные локально
5. Пользователь периодически видит свой прогресс на загруженной карте
6. После возвращения в зону покрытия пользователь включает синхронизацию
7. Система загружает данные на сервер
8. Система обрабатывает данные и добавляет тренировку в историю

### Альтернативный поток A: Частичная синхронизация при слабом сигнале
1. В зоне слабого сигнала система пытается синхронизировать ключевые данные
2. Система отправляет только основные метрики (координаты, время старта/финиша)
3. Детальная телеметрия сохраняется для последующей синхронизации

### Альтернативный поток B: Ручная синхронизация
1. Пользователь вручную выбирает тренировки для синхронизации
2. Система показывает прогресс загрузки
3. При обрыве соединения система возобновляет загрузку с места остановки

### Постусловия:
Тренировка сохранена локально и синхронизирована при появлении соединения. Данные доступны в облаке.

---

## Матрица трассируемости сценариев использования

| Use Case ID | Название | Соответствующие бизнес-требования | Основные архитектурные компоненты |
|-------------|----------|-----------------------------------|-----------------------------------|
| UC-001 | Регистрация и создание профиля | 1, 4 | User Service, Auth Service, Recommendation Service |
| UC-002 | Завершение тренировки с трекингом | 2, 4, 5, 9 | Workout Service, Device Integration, Analytics Engine |
| UC-003 | Создание социальной группы | 1, 3 | Social Graph Service, Group Service, Notification Service |
| UC-004 | Участие в групповом челлендже | 1, 2, 7 | Gamification Engine, Social Graph Service, Notification Service |
| UC-005 | Получение рекомендаций по обновлению экипировки | 4, 8, 10, 11 | Recommendation Service, Analytics Engine, E-commerce Integration |
| UC-006 | Организация оффлайн-встречи | 1, 3 | Event Service, Social Graph Service, Notification Service |
| UC-007 | Использование в регионе без интернета | 1, 2, 5 | Offline Sync Service, Workout Service, Map Service |

---

## Примечания по реализации

1. **Приоритизация:** Use Cases UC-001, UC-002, UC-003 являются критическими для MVP.
2. **Зависимости:** UC-004 зависит от UC-002 и UC-003. UC-005 зависит от UC-002.
3. **Особые требования:** UC-007 требует специальной обработки на клиентской стороне и механизма разрешения конфликтов при синхронизации.
4. **Безопасность:** Во всех Use Cases требуется проверка авторизации и контроль доступа к данным.
5. **Производительность:** UC-002 и UC-004 требуют оптимизации для работы в реальном времени.

Эти сценарии использования будут использоваться для проектирования API, пользовательских интерфейсов и тестирования системы.
